model Category {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Menu      Menu[]

  @@schema("binkitchen")
}

model Menu {
  id         Int         @id @default(autoincrement())
  name       String
  image      String
  price      Float
  category   Category?   @relation(fields: [categoryId], references: [id])
  categoryId Int?
  orderItems OrderItem[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt

  @@schema("binkitchen")
}

model Order {
  id        Int         @id @default(autoincrement())
  status    String      @default("PENDING")
  tableId   Int
  items     OrderItem[]
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt

  @@schema("binkitchen")
}

model OrderItem {
  id         Int      @id @default(autoincrement())
  menu       Menu     @relation(fields: [menuId], references: [id])
  menuId     Int
  order      Order?   @relation(fields: [orderId], references: [id])
  orderId    Int?
  quantity   Int
  totalPrice Float
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@schema("binkitchen")
}

model QuizCategory {
  id        Int      @id @default(autoincrement())
  name      String
  quizzes   Quiz[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Category")
  @@schema("binquiz")
}

model Choice {
  id             Int      @id @default(autoincrement())
  answerText     String
  quiz           Quiz?    @relation(name: "choices", fields: [quizId], references: [id])
  quizId         Int?
  correctQuizzes Quiz[]   @relation(name: "correctChoice")
  rounds         Round[]
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@schema("binquiz")
}

model Quiz {
  id              Int          @id @default(autoincrement())
  questionText    String
  category        QuizCategory @relation(fields: [quizCategoryId], references: [id])
  quizCategoryId  Int
  choices         Choice[]     @relation(name: "choices")
  correctChoice   Choice       @relation(name: "correctChoice", fields: [correctChoiceId], references: [id])
  correctChoiceId Int
  rounds          Round[]
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  @@schema("binquiz")
}

model Round {
  id              Int      @id @default(autoincrement())
  quizzes         Quiz[]
  selectedChoices Choice[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@schema("binquiz")
}

model FacebookUser {
  id                     Int                    @id @default(autoincrement())
  name                   String
  imageUrl               String
  bio                    String
  followingUserRelations FacebookUserRelation[] @relation("followingUser")
  followedUserRelations  FacebookUserRelation[] @relation("followedUser")
  posts                  Post[]
  comments               Comment[]
  messengerMessagesFrom  MessengerMessage[]     @relation("fromUser")
  messengerMessagesTo    MessengerMessage[]     @relation("toUser")
  createdAt              DateTime               @default(now())
  updatedAt              DateTime               @updatedAt

  @@map("User")
  @@schema("facebook")
}

// https://www.prisma.io/docs/concepts/components/prisma-schema/relations/self-relations

model FacebookUserRelation {
  id              Int          @id @default(autoincrement())
  followingUser   FacebookUser @relation("followingUser", fields: [followingUserId], references: [id])
  followingUserId Int
  followedUser    FacebookUser @relation("followedUser", fields: [followedUserId], references: [id])
  followedUserId  Int
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  @@map("UserRelation")
  @@schema("facebook")
}

model Post {
  id          Int               @id @default(autoincrement())
  postText    String
  postingUser FacebookUser      @relation(fields: [userId], references: [id])
  userId      Int
  comments    Comment[]
  hashTags    FacebookHashTag[]
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  @@schema("facebook")
}

model Comment {
  id              Int          @id @default(autoincrement())
  commentText     String
  commentingUser  FacebookUser @relation(fields: [userId], references: [id])
  userId          Int
  parentPost      Post         @relation(fields: [postId], references: [id])
  postId          Int
  parentComment   Comment?     @relation("parentComment", fields: [parentCommentId], references: [id])
  parentCommentId Int?
  childComments   Comment[]    @relation("parentComment")
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  @@schema("facebook")
}

model FacebookHashTag {
  id          Int      @id @default(autoincrement())
  hashTagText String
  isInPosts   Post[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("HashTag")
  @@schema("facebook")
}

model MessengerMessage {
  id            Int          @id @default(autoincrement())
  messengerText String
  fromUser      FacebookUser @relation("fromUser", fields: [fromUserId], references: [id])
  toUser        FacebookUser @relation("toUser", fields: [toUserId], references: [id])
  fromUserId    Int
  toUserId      Int
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt

  @@schema("facebook")
}

model TodoList {
  id        Int      @id @default(autoincrement())
  task      String
  status    String   @default("PENDING")
  bgColor   String   @default("slate")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@schema("todolist")
}

model User {
  id                     Int             @id @default(autoincrement())
  name                   String
  imageUrl               String
  bio                    String
  followingUserRelations UserRelation[]  @relation("followingUser")
  followedUserRelations  UserRelation[]  @relation("followedUser")
  tweets                 Tweet[]
  directMessagesFrom     DirectMessage[] @relation("fromUser")
  directMessagesTo       DirectMessage[] @relation("toUser")
  createdAt              DateTime        @default(now())
  updatedAt              DateTime        @updatedAt

  @@schema("twitter")
}

// https://www.prisma.io/docs/concepts/components/prisma-schema/relations/self-relations

model UserRelation {
  id              Int      @id @default(autoincrement())
  followingUser   User     @relation("followingUser", fields: [followingUserId], references: [id])
  followingUserId Int
  followedUser    User     @relation("followedUser", fields: [followedUserId], references: [id])
  followedUserId  Int
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@schema("twitter")
}

model Tweet {
  id            Int       @id @default(autoincrement())
  tweetText     String
  tweetingUser  User      @relation(fields: [userId], references: [id])
  parentTweet   Tweet?    @relation("parentTweet", fields: [parentTweetId], references: [id])
  parentTweetId Int?
  childTweets   Tweet[]   @relation("parentTweet")
  userId        Int
  hashTags      HashTag[]
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  @@schema("twitter")
}

model HashTag {
  id          Int      @id @default(autoincrement())
  hashTagText String
  isInTweets  Tweet[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@schema("twitter")
}

model DirectMessage {
  id         Int      @id @default(autoincrement())
  dmText     String
  fromUser   User     @relation("fromUser", fields: [fromUserId], references: [id])
  toUser     User     @relation("toUser", fields: [toUserId], references: [id])
  fromUserId Int
  toUserId   Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@schema("twitter")
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["todolist", "binkitchen", "binquiz", "twitter", "facebook", "youtube"]
}

generator client {
  provider        = "prisma-client-js"
  binaryTargets   = ["native", "darwin-arm64", "debian-openssl-1.1.x"]
  output          = "../prisma/client"
  previewFeatures = ["multiSchema"]
}

model YouTubeUser {
  id                         Int                       @id @default(autoincrement())
  name                       String
  profileImageUrl            String
  bio                        String
  memberOfChannels           Channel[]                 @relation("memberOfChannels")
  usersToChannelswithRoles   UserToChannelwithRole[]
  subscribingToChannels      Channel[]                 @relation("subscribingToChannels")
  reactedVideos              Video[]
  usersToVideosWithReactions UserToVideoWithReaction[]
  videoComments              VideoComment[]
  createdAt                  DateTime                  @default(now())
  updatedAt                  DateTime                  @updatedAt

  @@map("User")
  @@schema("youtube")
}

model Channel {
  id                       Int                     @id @default(autoincrement())
  name                     String
  profileImageUrl          String
  description              String
  memberUsers              YouTubeUser[]           @relation("memberOfChannels")
  subscribedUsers          YouTubeUser[]           @relation("subscribingToChannels")
  usersToChannelswithRoles UserToChannelwithRole[]
  owningVideos             Video[]
  createdAt                DateTime                @default(now())
  updatedAt                DateTime                @updatedAt

  @@schema("youtube")
}

enum Role {
  MANAGER
  EDITOR
  VIEWER

  @@schema("youtube")
}

model UserToChannelwithRole {
  id            Int         @id @default(autoincrement())
  user          YouTubeUser @relation(fields: [youTubeUserId], references: [id])
  youTubeUserId Int
  channel       Channel     @relation(fields: [channelId], references: [id])
  channelId     Int
  role          Role
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  @@schema("youtube")
}

model Video {
  id                         Int                       @id @default(autoincrement())
  title                      String
  videoUrl                   String
  thumbnailImageUrl          String
  description                String
  belongsToChannel           Channel                   @relation(fields: [channelId], references: [id])
  channelId                  Int
  reactedByYouTubeUsers      YouTubeUser[]
  usersToVideosWithReactions UserToVideoWithReaction[]
  videoComments              VideoComment[]
  createdAt                  DateTime                  @default(now())
  updatedAt                  DateTime                  @updatedAt

  @@schema("youtube")
}

enum Reaction {
  LIKE
  DISLIKE

  @@schema("youtube")
}

model UserToVideoWithReaction {
  id            Int         @id @default(autoincrement())
  user          YouTubeUser @relation(fields: [youTubeUserId], references: [id])
  youTubeUserId Int
  video         Video       @relation(fields: [videoId], references: [id])
  videoId       Int
  reaction      Reaction
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  @@schema("youtube")
}

model VideoComment {
  id                   Int            @id @default(autoincrement())
  commentText          String
  commentingUser       YouTubeUser    @relation(fields: [youTubeUserId], references: [id])
  youTubeUserId        Int
  parentVideo          Video          @relation(fields: [videoId], references: [id])
  videoId              Int
  parentVideoComment   VideoComment?  @relation("parentVideoComment", fields: [parentVideoCommentId], references: [id])
  parentVideoCommentId Int?
  childVideoComments   VideoComment[] @relation("parentVideoComment")
  createdAt            DateTime       @default(now())
  updatedAt            DateTime       @updatedAt

  @@schema("youtube")
}
